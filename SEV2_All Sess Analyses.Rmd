---
title: "Sess 1-3 Analysis"
author: "A DuBois"
date: '2022-06-14'
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Load packages

```{r packages}
library(tidyverse)
library(readxl)
library(ggplot2)
library(lubridate)

```


# Read in data

```{r read & clean data}

#read in and combine data

#training data on remembered sensations
Training.df<- read_excel("data/SEV_v2_-_Training_-_Raw_Data.xlsx", sheet = 4, skip = 3) %>%
  rename(Rating = `Please mark the perceived intensity of {{sample_name}} exactly as you recorded it on your paper sheet.`) %>%
  mutate(Session = 1) %>%
  bind_rows(read_excel("data/SEV_v2_-_Training_refresher_for_sess_2_-_Raw_Data.xlsx", sheet = 4, skip = 3) %>%
              rename(Rating = `Please mark the perceived intensity of {{sample_name}} on the scale below.(You may also mark them on your paper scale if you would like but it is not required.)`) %>%
              mutate(Session = 2)) %>%
  transmute(SubjectCode = `Participant Code`,
            SampleName = `Sample Name`,
            Rating,
            Session) 


#data on test samples
df <- read_excel("data/SEV_v2_-_Session_1_-_Raw_Data.xlsx", sheet = 3, skip = 3) %>%
  bind_rows(read_excel("data/SEV_v2_-_Session_2_-_Raw_Data.xlsx", sheet = 4, skip = 3)) %>%
  transmute(SubjectCode = `Participant Code`,
            SampleName = `Sample Name`,
            Rep = `Repetition`,
            SweetRating = `Please take a sip of sample {{sample_code}} and rate the intensity of sweetness only.Sweetness:  the pleasant taste sensation typically produced by sugars (such as sucrose or glucose)`,
            FlavRating = `Please take a sip of sample {{sample_code}} and rate the intensity of flavor only.Flavor: the combined effect of taste sensations, aromas, and chemical feeling factors (e.g. burn of a chili, cooling of menthol) in the mouth.`
            ) %>%
  separate(SampleName, into = c("SampleCode", "Sample"), sep = ". ")

```
# plot data

``` {r plotting test data}

df %>%
  group_by(SampleCode)%>%
  summarise(FlavMean = mean(FlavRating),
            SweetMean = mean(SweetRating)) %>%
    pivot_longer(FlavMean:SweetMean,
               names_to = "Sensation",
               values_to = "Rating") %>%
  ggplot(aes(reorder(SampleCode, Rating), Rating, color = Sensation, shape = Sensation))+
    geom_point() +
    ylim(0,100) +
    theme_minimal() +
    theme(axis.text.x = element_text(angle = 45, hjust = 1))

## SW @ 20 for sweet, 14 for flav


```